{{ range $index, $e := until (.Values.geth.private_tx_nodes | int) }}

{{ $loadBalancerIP := default "" (index $.Values.geth (print "private_tx_nodes_" $index "IpAddress")) }}

{{ template "celo.node-service" (dict "Values" $.Values "Release" $.Release "Chart" $.Chart "index" $index "service_type" "LoadBalancer" "svc_name" "tx-node-private" "node_name" "tx-nodes-private" "component_label" "private_tx_nodes" "load_balancer_ip" $loadBalancerIP ) }}
  ports:
  - name: discovery
    port: 30303
    protocol: UDP
---
{{ template "celo.node-service" (dict "Values" $.Values "Release" $.Release "Chart" $.Chart "index" $index "service_type" "LoadBalancer" "svc_name" "tx-node-private" "node_name" "tx-nodes-private" "svc_name_suffix" "-tcp" "component_label" "private_tx_nodes" "load_balancer_ip" $loadBalancerIP ) }}
  ports:
  - name: celo
    port: 30303
    protocol: TCP
---
{{ end }}
